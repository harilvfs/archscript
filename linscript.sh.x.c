#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f linscript.sh -o linbinary 
#endif

static  char data [] = 
#define      date_z	1
#define      date	((&data[0]))
	"\144"
#define      chk1_z	22
#define      chk1	((&data[1]))
	"\166\136\331\164\011\137\316\364\112\245\127\146\145\255\265\072"
	"\157\230\241\167\166\265\360\116\077"
#define      inlo_z	3
#define      inlo	((&data[26]))
	"\115\111\374"
#define      xecc_z	15
#define      xecc	((&data[29]))
	"\127\146\130\351\247\005\050\260\212\323\265\230\307\076\061\126"
	"\044"
#define      tst1_z	22
#define      tst1	((&data[51]))
	"\300\344\047\250\017\236\271\201\336\337\030\245\172\005\143\125"
	"\333\131\152\022\313\313\241\120\264\051\035\166\301\047"
#define      shll_z	10
#define      shll	((&data[76]))
	"\247\323\232\352\333\133\073\001\034\154\125\347"
#define      tst2_z	19
#define      tst2	((&data[92]))
	"\215\320\100\315\337\116\056\123\110\376\077\216\112\110\164\365"
	"\063\376\046\346\245\263\323\043\202\076\147"
#define      msg2_z	19
#define      msg2	((&data[119]))
	"\303\111\260\105\014\046\346\357\070\054\323\045\235\145\371\373"
	"\314\336\046\013\101\214\322\012\225\154"
#define      rlax_z	1
#define      rlax	((&data[141]))
	"\064"
#define      lsto_z	1
#define      lsto	((&data[142]))
	"\100"
#define      opts_z	1
#define      opts	((&data[143]))
	"\050"
#define      text_z	5916
#define      text	((&data[719]))
	"\117\361\021\220\276\064\022\374\234\262\314\132\166\026\013\273"
	"\040\240\050\323\105\013\110\020\026\276\212\167\033\355\270\153"
	"\336\311\373\234\376\015\231\233\277\146\366\066\174\001\361\235"
	"\242\032\161\347\046\272\370\075\170\202\264\224\160\154\377\117"
	"\066\373\354\064\010\205\320\310\353\306\376\150\310\360\006\152"
	"\012\167\122\060\062\113\155\252\315\042\076\076\217\076\215\305"
	"\071\171\371\102\377\311\012\353\220\011\124\130\371\132\303\004"
	"\322\026\065\004\141\243\256\057\306\355\156\125\054\373\032\145"
	"\165\024\247\165\336\262\140\156\273\264\307\265\017\213\272\341"
	"\241\360\345\003\224\224\063\132\202\241\257\256\234\311\024\022"
	"\336\273\207\274\156\350\052\052\235\362\337\254\175\232\215\037"
	"\212\163\043\037\010\126\171\212\367\050\071\224\362\115\247\320"
	"\011\057\214\167\027\267\241\264\251\201\141\047\033\356\106\246"
	"\142\151\306\152\300\077\365\270\150\056\115\133\174\364\054\205"
	"\043\271\374\073\160\235\360\032\037\121\101\073\100\210\342\242"
	"\362\250\015\262\347\003\152\117\061\267\253\255\254\327\063\317"
	"\220\057\013\001\315\373\033\354\114\134\047\215\345\011\057\327"
	"\261\075\211\230\100\364\350\162\254\224\040\130\153\123\050\374"
	"\202\063\375\120\056\030\074\173\165\143\010\132\154\070\062\036"
	"\166\273\266\267\260\237\051\134\063\112\264\237\236\334\233\041"
	"\017\230\161\076\261\255\272\046\020\303\201\175\374\263\233\162"
	"\157\122\052\037\361\124\173\045\236\060\304\074\014\137\135\034"
	"\370\317\133\251\174\025\317\215\330\121\012\325\005\246\110\165"
	"\370\162\224\352\306\020\020\144\100\324\241\115\064\377\152\054"
	"\316\305\325\112\332\245\330\263\367\342\210\374\210\320\161\201"
	"\102\006\153\010\027\174\155\130\120\017\245\205\016\020\261\335"
	"\325\207\050\257\055\000\142\044\343\353\041\153\274\223\355\376"
	"\232\131\007\261\325\165\011\046\205\257\253\223\277\135\161\224"
	"\345\231\104\022\232\247\067\175\222\130\351\117\353\326\115\205"
	"\057\125\067\005\313\101\053\120\360\327\344\260\065\125\105\032"
	"\357\212\054\211\061\144\007\304\274\360\023\250\306\141\056\366"
	"\267\145\373\202\246\047\323\227\377\267\110\064\015\216\116\375"
	"\030\173\207\111\337\216\016\233\176\041\104\105\203\162\073\072"
	"\330\067\275\177\137\220\027\136\110\137\222\126\355\341\123\006"
	"\134\333\120\073\151\136\327\350\200\033\055\003\216\151\075\146"
	"\241\372\346\001\212\375\137\323\134\362\051\112\323\175\121\211"
	"\212\115\221\116\112\034\110\126\042\205\063\177\204\216\264\120"
	"\072\120\141\337\066\221\206\253\213\343\302\235\060\154\361\271"
	"\342\216\350\315\040\352\112\275\317\030\000\024\142\300\145\117"
	"\360\005\110\030\074\350\171\140\015\320\337\206\125\063\227\051"
	"\257\303\020\115\353\073\137\062\101\072\330\363\023\263\032\273"
	"\066\165\010\340\317\251\263\205\370\046\074\166\013\066\341\277"
	"\264\347\073\230\164\307\105\247\124\022\335\250\370\265\344\055"
	"\105\376\147\212\240\227\323\042\351\237\143\202\037\201\325\045"
	"\372\225\075\255\165\017\060\052\057\001\057\307\074\177\212\033"
	"\367\173\174\042\240\126\274\021\043\026\021\022\321\232\251\263"
	"\216\360\345\113\033\320\020\211\235\062\126\065\150\223\275\073"
	"\120\350\315\355\351\016\253\301\130\047\173\371\107\172\310\050"
	"\221\153\277\044\353\233\266\247\361\106\321\311\310\223\203\272"
	"\144\002\221\233\336\177\266\101\124\161\073\005\356\042\142\165"
	"\057\346\014\365\064\332\142\351\071\067\172\376\250\374\304\020"
	"\145\106\050\017\351\165\010\003\017\024\353\112\111\174\162\131"
	"\007\212\366\052\260\033\124\161\070\125\036\335\354\224\273\305"
	"\174\334\164\076\354\135\323\265\141\103\264\325\116\024\365\357"
	"\031\155\162\005\334\205\031\312\142\146\364\127\152\336\161\347"
	"\031\050\361\023\064\071\346\334\232\305\342\375\226\130\114\132"
	"\354\362\054\164\005\037\205\012\356\047\150\013\232\161\013\067"
	"\252\177\311\225\322\154\132\273\343\140\027\352\146\364\260\135"
	"\201\253\257\176\254\267\203\042\136\310\013\134\202\364\226\217"
	"\364\272\276\137\036\345\104\167\160\162\031\121\343\276\243\176"
	"\135\250\020\202\234\315\104\167\110\113\274\355\056\037\253\143"
	"\074\252\213\252\034\170\035\307\112\372\215\135\344\033\323\344"
	"\113\173\263\006\247\143\151\124\267\174\340\106\271\153\332\356"
	"\073\227\321\323\151\007\231\144\367\155\242\227\361\033\131\144"
	"\120\222\321\045\263\302\335\204\246\345\366\000\077\212\021\071"
	"\135\151\020\304\142\370\376\015\077\165\113\071\350\060\013\232"
	"\115\306\234\025\041\012\347\036\041\171\057\325\220\106\102\215"
	"\104\333\027\146\327\156\217\055\157\045\126\327\320\064\366\162"
	"\312\132\166\113\377\226\024\313\236\122\006\145\171\142\114\166"
	"\377\160\163\053\227\326\335\133\014\133\047\375\156\141\325\225"
	"\216\301\223\213\315\157\015\154\141\236\241\253\063\051\115\065"
	"\212\320\065\163\030\012\130\301\061\347\032\271\034\205\031\065"
	"\227\121\062\001\302\323\333\134\026\364\231\074\310\353\223\337"
	"\142\144\240\243\150\360\253\017\354\206\321\062\026\373\174\242"
	"\135\240\040\141\046\325\047\064\174\122\134\312\151\016\242\054"
	"\054\172\107\256\347\156\045\136\041\207\176\252\147\022\240\046"
	"\356\223\040\213\142\301\375\370\041\241\066\311\012\005\117\204"
	"\025\321\322\203\245\024\031\151\311\134\165\335\305\370\364\224"
	"\207\201\100\223\346\343\305\052\101\220\107\204\353\253\057\333"
	"\152\066\217\154\005\235\335\042\156\333\364\117\130\363\151\140"
	"\152\374\151\200\237\346\076\223\256\306\334\074\022\264\111\312"
	"\137\346\160\037\143\203\160\323\257\146\032\105\055\043\041\176"
	"\314\233\113\110\066\261\045\066\106\165\144\262\073\367\017\330"
	"\073\335\235\076\127\124\037\213\311\077\001\142\121\156\126\112"
	"\174\340\024\140\377\151\127\135\111\375\252\211\100\064\214\072"
	"\055\371\161\311\101\046\136\353\053\200\377\225\150\344\271\333"
	"\372\125\040\273\237\202\340\367\072\012\355\001\120\251\312\304"
	"\310\225\256\226\077\057\307\361\063\371\211\220\104\146\310\123"
	"\111\124\374\346\310\013\274\277\336\223\364\140\237\343\316\153"
	"\002\306\120\113\074\153\115\033\245\257\322\233\121\026\217\157"
	"\366\342\353\331\047\171\342\253\367\120\312\335\340\363\054\047"
	"\317\105\163\114\014\147\255\317\210\135\060\310\262\341\300\370"
	"\012\334\260\257\142\053\351\046\131\041\155\324\126\301\163\256"
	"\011\020\040\172\264\110\243\016\105\026\251\072\056\101\273\213"
	"\204\030\034\252\267\060\174\213\267\341\311\166\114\076\344\203"
	"\011\325\363\161\074\070\271\037\305\303\363\002\363\020\026\005"
	"\203\370\331\050\313\365\135\245\132\211\355\164\040\125\317\127"
	"\363\206\243\232\001\245\307\171\036\301\341\261\106\122\373\226"
	"\103\341\144\167\137\121\140\013\163\350\156\360\144\031\246\041"
	"\252\116\242\102\153\154\314\174\155\225\242\321\323\070\024\171"
	"\320\163\071\051\373\256\036\057\232\022\325\007\313\052\332\236"
	"\133\265\042\166\323\160\217\375\022\052\361\261\167\254\374\310"
	"\251\244\211\360\374\102\255\036\350\376\270\110\032\216\134\250"
	"\123\323\104\235\217\001\362\154\072\333\244\267\263\055\273\250"
	"\061\055\374\302\312\252\277\124\057\030\333\027\124\362\126\222"
	"\137\355\223\255\344\206\275\145\235\303\223\102\146\061\024\030"
	"\321\151\261\035\015\351\307\070\225\123\276\150\102\036\110\050"
	"\274\242\055\347\114\377\054\307\315\253\041\344\156\202\330\201"
	"\140\231\261\313\203\162\360\154\202\013\204\305\072\157\366\347"
	"\127\001\337\354\037\137\220\103\146\301\055\031\017\024\162\135"
	"\261\113\243\370\272\211\166\215\313\337\371\213\255\167\315\152"
	"\354\202\003\063\366\210\352\357\073\052\346\011\103\311\311\357"
	"\217\300\010\356\177\155\077\031\014\044\147\135\271\221\023\266"
	"\207\037\030\121\272\135\031\063\121\341\360\252\106\122\023\122"
	"\370\033\116\333\352\372\347\215\334\166\013\132\036\063\007\046"
	"\276\252\257\001\054\316\247\015\167\261\142\334\357\122\301\116"
	"\365\051\013\045\240\020\013\244\317\066\305\370\113\371\263\331"
	"\316\014\370\061\222\277\075\130\362\031\162\032\366\271\200\113"
	"\141\203\344\360\207\050\157\023\173\342\143\131\100\277\072\050"
	"\335\216\036\137\323\005\137\136\343\050\333\307\044\304\030\114"
	"\267\103\105\163\127\326\111\176\220\304\303\277\175\251\100\004"
	"\136\137\045\034\333\166\224\046\145\217\030\131\274\372\376\216"
	"\046\106\244\064\006\315\006\061\117\007\043\062\146\220\327\077"
	"\130\030\341\311\315\122\111\217\154\227\331\040\107\340\057\007"
	"\136\244\050\214\256\055\145\231\235\235\243\344\301\304\012\125"
	"\247\345\050\353\057\153\144\205\236\226\023\356\137\165\160\150"
	"\022\107\277\374\025\263\135\141\375\354\267\302\010\057\157\033"
	"\226\322\177\000\054\307\206\131\166\101\150\136\334\344\167\131"
	"\174\023\257\340\346\020\133\237\372\042\135\362\333\112\040\130"
	"\076\321\313\313\121\310\345\320\017\213\044\142\067\006\145\000"
	"\331\027\025\126\223\344\042\352\114\152\034\027\176\000\307\232"
	"\337\164\200\332\305\161\277\112\310\100\001\021\175\034\001\060"
	"\360\343\204\105\263\265\205\301\250\231\206\346\001\367\300\245"
	"\207\026\043\247\037\270\132\336\071\365\302\236\176\045\051\064"
	"\232\145\327\103\100\370\160\131\173\323\023\310\031\373\374\345"
	"\000\221\013\234\210\054\056\055\130\063\021\013\154\051\165\014"
	"\264\205\037\276\167\256\170\152\302\035\250\234\335\116\235\020"
	"\211\316\031\356\223\030\267\065\055\371\376\341\027\317\274\330"
	"\336\151\110\257\211\310\177\176\024\065\106\315\023\176\047\154"
	"\270\041\077\041\337\267\317\024\266\241\106\255\123\146\343\346"
	"\162\171\104\357\251\036\373\075\157\311\226\374\240\172\072\070"
	"\375\346\002\153\056\042\334\050\336\216\175\330\351\115\270\310"
	"\353\024\236\026\147\326\165\234\275\122\267\226\355\330\260\327"
	"\174\221\376\224\325\005\127\140\047\174\266\065\232\025\321\175"
	"\050\372\173\010\322\260\275\070\111\223\216\260\007\206\102\103"
	"\162\240\131\232\100\156\311\136\227\357\036\254\060\023\113\004"
	"\264\135\215\204\266\155\272\146\074\146\203\024\112\050\123\206"
	"\117\221\030\150\132\067\030\017\223\366\122\236\333\370\376\244"
	"\033\163\166\016\335\031\366\153\143\004\154\001\317\133\225\073"
	"\171\200\303\244\354\326\105\377\133\274\264\221\307\321\306\037"
	"\327\361\037\224\017\044\231\065\067\364\366\056\106\325\355\100"
	"\201\136\076\001\170\302\327\254\252\116\103\033\124\250\143\323"
	"\116\371\273\147\374\122\204\150\263\142\040\112\200\254\251\056"
	"\341\332\216\231\337\264\347\224\150\377\017\204\373\233\153\213"
	"\175\067\203\075\232\371\033\222\341\244\154\062\221\127\010\013"
	"\162\153\052\367\136\064\322\157\345\311\151\156\124\201\212\102"
	"\374\100\172\131\167\243\105\266\061\327\027\345\101\005\376\260"
	"\201\004\257\377\042\273\177\375\235\137\066\251\145\036\366\071"
	"\016\315\337\027\075\165\150\342\024\126\165\316\014\160\027\324"
	"\225\037\256\212\124\017\260\221\361\102\142\343\237\200\274\121"
	"\024\033\105\124\257\075\045\035\346\032\041\212\060\253\120\240"
	"\074\151\352\310\254\107\107\203\200\053\237\365\234\025\117\110"
	"\056\356\321\370\044\204\344\034\003\160\336\351\213\315\371\034"
	"\176\124\365\334\247\025\074\344\150\243\100\200\056\120\152\012"
	"\324\306\125\045\377\111\032\143\202\156\223\050\140\007\237\044"
	"\205\344\175\074\152\167\211\141\346\102\140\350\271\110\265\161"
	"\023\007\346\257\225\243\325\316\206\342\145\003\250\112\354\263"
	"\225\275\060\364\220\252\010\316\010\142\022\171\304\212\141\022"
	"\020\063\017\142\227\072\245\163\175\337\044\114\201\037\377\245"
	"\372\136\145\037\046\137\345\177\332\330\300\103\063\104\254\344"
	"\003\040\204\057\225\215\324\030\067\221\353\027\114\175\130\006"
	"\244\154\042\127\137\262\355\045\234\124\001\203\164\122\371\000"
	"\354\324\131\131\032\123\016\226\154\165\112\307\136\001\063\272"
	"\376\262\211\102\341\013\152\200\066\231\040\253\043\343\171\031"
	"\205\155\222\073\214\172\245\316\342\212\336\356\130\001\373\132"
	"\121\117\322\201\247\137\330\340\211\236\012\204\047\121\271\323"
	"\075\274\212\230\146\200\377\141\245\123\331\250\200\322\263\352"
	"\176\052\316\005\224\126\303\131\262\203\233\172\360\033\012\245"
	"\326\336\321\310\005\152\251\324\062\044\375\222\326\164\344\153"
	"\252\353\135\237\344\232\356\144\163\041\232\146\257\050\047\004"
	"\037\045\210\104\123\370\071\145\322\122\114\067\202\156\042\105"
	"\136\313\314\172\102\313\126\330\232\327\042\277\200\253\014\030"
	"\007\334\156\113\375\117\225\277\113\276\362\325\045\166\175\234"
	"\150\343\114\351\101\113\046\244\012\036\203\112\032\043\220\271"
	"\101\254\360\034\262\211\017\267\110\035\216\045\076\022\151\176"
	"\243\314\310\237\224\267\310\257\316\270\150\334\024\117\222\037"
	"\015\013\262\001\015\127\375\145\066\355\005\216\323\014\077\037"
	"\067\363\212\025\140\016\062\167\107\135\377\056\271\021\065\215"
	"\277\157\021\047\104\150\207\014\204\146\157\130\216\134\005\020"
	"\355\266\356\202\044\110\146\142\360\247\170\375\250\020\226\264"
	"\014\116\047\115\147\332\164\151\343\172\033\266\274\357\244\001"
	"\035\366\164\147\240\257\145\104\017\255\013\372\142\264\145\076"
	"\033\360\132\060\006\336\375\304\364\001\145\347\120\350\175\103"
	"\355\176\352\034\133\342\202\104\124\201\356\336\226\113\224\224"
	"\306\273\043\035\163\251\155\345\157\053\042\226\017\370\162\342"
	"\167\165\247\371\053\353\171\206\035\253\064\173\174\334\242\266"
	"\210\003\011\157\361\274\000\226\063\065\121\071\055\076\054\233"
	"\273\036\050\065\227\052\345\007\001\001\351\162\113\310\070\340"
	"\142\353\015\375\203\216\324\362\316\142\252\270\302\320\166\057"
	"\103\317\322\240\265\237\250\333\223\164\366\220\255\325\373\120"
	"\303\042\303\373\360\233\276\270\160\261\052\316\347\034\351\001"
	"\150\266\065\030\121\243\143\373\217\056\350\061\133\165\133\343"
	"\334\141\351\324\214\241\212\030\002\226\043\324\356\217\265\200"
	"\221\344\312\024\013\135\004\334\257\176\335\012\114\046\044\020"
	"\364\020\124\160\055\273\017\212\241\120\054\324\013\330\231\011"
	"\023\002\301\071\376\307\041\240\026\140\273\075\315\146\017\172"
	"\046\311\361\342\030\330\252\047\306\265\267\060\150\041\165\321"
	"\167\124\022\223\367\046\013\022\126\372\316\332\125\173\313\266"
	"\314\010\115\213\355\077\162\222\365\145\210\176\250\333\351\332"
	"\301\312\110\233\257\121\357\343\273\160\153\323\224\015\033\221"
	"\346\000\265\103\137\352\376\336\376\205\077\225\062\056\030\004"
	"\362\171\336\113\250\000\030\124\372\304\262\025\344\302\216\377"
	"\066\066\050\244\040\237\323\027\201\211\071\276\223\041\240\156"
	"\325\147\063\053\121\126\006\336\052\127\254\304\175\012\354\370"
	"\214\300\206\360\351\153\232\242\066\327\225\154\236\243\337\054"
	"\001\173\305\215\231\116\000\155\117\301\004\252\103\200\350\350"
	"\237\267\113\132\067\363\001\370\105\072\224\274\273\147\155\273"
	"\276\120\126\343\150\167\377\063\046\140\163\005\244\376\224\071"
	"\072\306\367\014\165\124\373\342\044\073\150\016\035\007\373\375"
	"\155\112\271\021\117\131\022\375\312\277\300\054\254\333\331\265"
	"\104\113\021\163\143\013\172\030\155\304\001\327\117\126\045\022"
	"\045\102\066\030\043\303\134\051\151\161\305\237\327\256\241\067"
	"\255\041\362\044\357\041\164\116\124\262\227\225\176\237\355\017"
	"\134\363\336\077\341\030\006\313\251\103\154\076\017\263\322\017"
	"\306\164\014\206\210\362\056\261\176\241\325\070\242\362\030\157"
	"\015\025\177\363\156\306\147\230\062\240\104\305\014\206\077\236"
	"\033\160\140\256\241\221\041\333\203\007\360\154\143\027\174\304"
	"\337\217\160\110\007\320\232\270\007\277\165\072\307\224\002\070"
	"\042\146\357\022\360\122\037\137\233\366\330\040\143\277\277\014"
	"\361\361\024\106\173\015\200\323\353\331\257\321\216\074\311\245"
	"\320\165\252\052\157\002\346\150\161\301\372\312\105\372\266\260"
	"\220\150\361\041\046\111\351\230\323\315\330\255\372\326\071\027"
	"\111\056\306\205\340\124\111\333\334\052\025\230\307\132\315\234"
	"\032\122\176\056\364\130\136\301\142\051\116\221\344\046\152\012"
	"\055\264\040\302\354\336\262\070\233\045\331\346\162\274\066\200"
	"\261\355\332\124\176\064\056\326\117\232\215\161\113\354\246\030"
	"\363\330\127\006\253\044\014\035\337\232\330\002\015\244\040\102"
	"\251\372\113\350\257\037\004\237\075\167\232\075\343\351\076\252"
	"\206\266\347\310\333\251\237\076\352\260\152\304\362\077\007\057"
	"\063\223\001\332\277\067\214\076\352\154\165\257\136\156\303\167"
	"\015\236\356\105\126\035\110\352\372\316\001\372\037\250\246\203"
	"\142\204\172\246\262\276\000\274\126\075\177\246\074\014\265\005"
	"\031\067\112\110\226\026\222\310\117\045\176\061\071\044\241\242"
	"\375\103\157\052\131\012\343\151\000\114\113\371\160\116\173\277"
	"\010\026\143\170\247\240\350\214\214\340\317\231\227\146\234\075"
	"\216\325\361\224\103\300\331\377\212\104\137\050\266\100\345\176"
	"\355\201\237\333\004\366\204\373\103\335\245\215\145\327\132\166"
	"\273\171\263\022\307\330\136\233\233\133\176\130\254\123\245\015"
	"\176\353\302\127\073\311\223\066\003\350\377\231\110\007\120\324"
	"\047\276\021\105\034\165\000\270\340\360\226\255\307\026\114\134"
	"\352\031\045\221\136\371\140\265\351\177\023\152\223\300\033\300"
	"\322\312\202\203\174\304\056\353\036\366\072\346\014\101\327\140"
	"\057\256\066\134\004\216\312\050\127\147\203\233\165\203\272\270"
	"\023\245\327\116\373\251\210\104\015\126\367\174\067\326\173\351"
	"\241\055\226\123\302\217\036\040\133\117\212\013\213\211\100\102"
	"\127\374\330\222\043\135\015\277\014\145\074\233\131\225\320\220"
	"\373\104\325\225\120\242\343\167\374\154\312\353\361\100\147\002"
	"\044\101\220\052\006\362\327\316\335\124\107\120\152\016\227\244"
	"\160\322\307\142\043\152\375\134\073\270\166\015\265\364\274\141"
	"\265\163\136\321\103\023\010\135\302\166\030\026\316\317\377\310"
	"\266\121\267\065\007\300\304\337\257\121\051\150\144\217\220\103"
	"\300\016\377\002\364\256\270\173\355\221\216\030\357\012\067\201"
	"\076\063\205\365\026\313\227\177\176\256\135\036\067\003\072\312"
	"\261\136\367\215\126\321\107\241\164\132\043\243\177\037\022\330"
	"\370\241\276\003\332\023\325\331\116\046\073\104\272\347\135\074"
	"\015\067\064\360\305\246\062\055\363\022\351\042\337\346\166\316"
	"\111\204\175\004\172\175\153\234\223\317\023\246\367\140\352\170"
	"\340\313\134\313\123\330\031\245\372\141\125\315\156\207\330\134"
	"\222\365\334\332\044\031\327\060\313\254\200\355\020\012\042\105"
	"\256\020\054\212\172\107\121\370\251\246\131\114\342\322\065\045"
	"\024\034\165\110\252\047\213\366\223\243\123\257\332\250\226\272"
	"\224\363\016\275\152\057\024\237\010\275\113\351\215\036\343\307"
	"\052\312\204\357\240\034\170\115\277\231\251\133\110\202\017\371"
	"\056\261\365\264\033\376\210\235\121\170\320\163\270\374\076\135"
	"\160\374\070\010\224\057\364\370\314\044\257\336\122\237\374\011"
	"\350\217\263\337\263\273\244\001\017\054\056\174\130\165\055\206"
	"\212\346\013\254\352\372\114\102\330\324\040\037\267\130\352\035"
	"\356\136\165\211\305\326\356\173\050\024\371\077\274\376\044\306"
	"\257\132\330\363\226\364\220\073\214\306\361\151\366\251\045\353"
	"\326\262\176\125\030\261\355\202\126\177\311\146\122\213\137\024"
	"\100\354\047\120\365\215\237\263\141\351\145\263\106\172\134\135"
	"\163\136\057\315\313\354\147\314\074\342\003\367\024\150\221\164"
	"\213\322\165\001\154\210\262\145\313\044\334\374\263\105\102\255"
	"\267\143\376\150\205\317\346\117\164\032\221\236\334\265\131\122"
	"\054\017\335\013\020\146\365\333\301\244\227\046\077\111\112\376"
	"\210\143\050\316\134\337\371\004\156\246\145\266\114\233\247\167"
	"\375\331\145\324\116\076\164\306\263\035\020\334\155\267\206\256"
	"\034\120\150\157\134\231\245\031\103\152\040\323\135\374\114\372"
	"\013\324\151\027\173\247\054\136\156\302\363\334\006\254\055\346"
	"\257\013\076\153\254\174\257\070\235\312\117\113\000\137\171\245"
	"\050\307\012\157\110\013\311\021\177\200\154\345\232\113\031\320"
	"\147\276\226\243\250\333\016\374\220\153\062\314\067\103\176\210"
	"\333\267\012\015\257\244\342\122\045\051\075\177\277\256\055\321"
	"\304\046\373\360\220\335\351\122\116\216\135\226\153\143\205\032"
	"\330\006\113\173\350\151\041\116\131\324\223\307\272\106\142\160"
	"\172\216\007\226\117\374\364\063\237\052\006\253\030\057\007\152"
	"\022\273\231\266\370\314\121\321\032\360\311\054\062\331\266\237"
	"\376\324\071\301\363\167\304\057\346\345\271\155\337\126\104\052"
	"\375\052\246\330\254\271\332\375\337\113\007\171\362\023\342\347"
	"\143\173\200\375\177\277\010\312\255\267\271\045\100\274\071\350"
	"\307\246\375\215\002\022\150\261\145\362\063\244\355\064\161\015"
	"\330\254\001\125\123\377\023\124\136\331\056\144\265\222\046\370"
	"\307\060\011\122\023\320\230\035\050\256\056\034\163\231\163\112"
	"\034\276\252\150\045\076\277\112\217\370\075\324\323\073\136\013"
	"\256\265\307\365\177\357\160\147\364\327\140\070\041\216\344\142"
	"\053\014\241\014\126\000\362\337\277\210\042\317\340\003\021\155"
	"\310\344\271\055\060\257\204\340\222\367\043\155\154\333\274\350"
	"\045\055\204\001\137\262\145\055\124\235\250\112\313\037\037\234"
	"\200\007\333\276\014\200\373\071\202\350\125\336\032\153\136\004"
	"\220\332\111\157\340\311\066\021\116\160\205\124\353\324\365\074"
	"\377\257\035\122\013\306\022\303\251\344\376\241\217\012\124\144"
	"\220\174\253\334\023\202\155\144\172\012\145\347\301\161\217\273"
	"\352\134\353\241\152\324\274\117\331\242\051\231\070\122\004\323"
	"\061\030\243\211\114\353\021\332\045\206\156\172\263\211\051\203"
	"\262\150\233\176\220\076\215\325\247\061\124\147\344\263\050\164"
	"\237\235\273\261\006\241\346\325\355\055\270\257\206\145\341\025"
	"\165\055\226\370\324\031\342\215\354\257\215\074\244\323\070\251"
	"\075\034\376\306\152\111\215\342\160\263\013\365\033\037\273\231"
	"\006\207\156\000\024\270\331\276\251\251\234\343\025\234\057\000"
	"\352\051\333\055\052\104\276\156\231\370\272\205\071\110\274\261"
	"\246\325\162\145\247\031\001\262\106\364\265\346\214\100\325\305"
	"\250\123\016\050\026\330\102\116\351\265\305\057\074\026\305\342"
	"\174\361\040\306\311\315\364\221\075\237\116\032\170\207\263\056"
	"\165\045\303\114\302\121\162\277\150\313\110\147\133\005\126\032"
	"\053\000\304\235\335\243\363\215\057\044\223\341\064\052\346\006"
	"\126\014\043\133\101\255\311\112\163\306\107\210\102\030\257\164"
	"\052\157\122\273\344\250\236\030\361\071\231\351\165\135\051\112"
	"\225\167\063\306\056\006\137\365\047\275\131\046\034\265\056\102"
	"\253\207\060\013\176\304\107\251\173\062\243\221\101\342\255\265"
	"\051\324\054\262\214\342\202\024\131\266\262\033\127\271\336\141"
	"\312\134\137\074\010\350\342\002\056\350\204\261\077\350\115\340"
	"\317\147\212\273\215\310\265\170\342\157\055\300\113\046\217\330"
	"\151\352\105\212\011\007\037\017\312\245\127\231\305\301\315\041"
	"\120\130\071\377\120\217\113\262\076\251\104\201\344\034\276\142"
	"\205\226\114\027\013\121\166\275\242\002\052\262\352\246\071\247"
	"\245\001\076\044\242\307\352\114\302\367\357\277\371\041\177\300"
	"\230\133\014\040\261\314\133\273\147\014\040\053\347\040\220\346"
	"\204\041\011\020\260\122\174\115\014\253\341\361\053\272\023\366"
	"\074\273\135\061\171\327\104\246\271\243\017\172\146\121\136\041"
	"\163\364\071\147\226\171\325\175\367\045\277\256\162\047\021\221"
	"\172\335\274\245\040\100\033\223\175\256\006\322\362\331\065\127"
	"\205\216\030\271\277\125\324\306\221\170\071\117\353\317\077\157"
	"\356\165\241\371\112\063\070\103\072\242\254\261\133\171\027\077"
	"\247\215\166\162\214\164\374\136\112\032\312\226\077\040\016\364"
	"\120\135\335\267\313\362\255\225\372\312\176\330\045\016\341\216"
	"\036\067\030\007\343\005\111\332\107\075\323\025\257\253\044\321"
	"\220\245\075\256\260\371\257\350\310\047\340\251\061\330\323\212"
	"\317\072\010\357\314\161\143\154\352\213\034\341\277\100\336\221"
	"\045\305\067\114\172\357\266\243\136\013\136\346\320\223\201\037"
	"\226\016\306\206\015\234\012\214\205\066\126\061\072\032\124\207"
	"\323\034\142\315\351\145\034\035\234\306\342\067\144\247\174\261"
	"\117\333\174\164\017\362\133\317\135\245\327\011\344\033\350\231"
	"\024\341\213\227\235\365\325\263\342\315\232\122\344\056\025\172"
	"\273\066\152\125\333\150\262\024\267\057\256\045\133\344\320\344"
	"\224\366\026\147\154\134\220\106\042\232\257\064\305\311\100\122"
	"\267\237\152\141\364\117\301\170\240\034\305\271\107\143\056\016"
	"\262\343\320\251\375\301\215\357\223\377\265\316\107\147\251\314"
	"\356\363\261\045\336\247\346\207\111\164\136\311\051\355\217\152"
	"\266\134\373\252\351\054\362\323\116\264\312\075\176\000\355\002"
	"\257\157\355\205\030\342\005\245\277\272\145\204\216\045\011\027"
	"\241\100\311\020\050\141\310\275\125\033\033\234\022\147\161\021"
	"\376\255\350\204\202\176\041\260\160\107\245\060\165\274\213\047"
	"\262\157\371\112\354\121\216\206\220\077\172\117\030\121\350\276"
	"\046\317\327\152\042\225\013\343\141\216\375\001\005\076\001\212"
	"\104\136\056\175\311\203\257\021\204\377\345\110\003\103\122\034"
	"\264\237\307\335\016\131\217\361\354\262\051\106\305\072\014\050"
	"\015\264\076\063\040\063\376\363\210\304\230\040\114\007\061\104"
	"\263\260\326\303\077\316\241\025\174\140\055\114\330\276\311\004"
	"\120\110\317\354\016\253\244\330\330\315\020\053\204\373\304\125"
	"\072\325\345\364\333\356\147\152\006\237\322\342\202\332\160\007"
	"\203\301\012\327\267\064\225\110\305\013\053\211\277\133\162\147"
	"\200\160\004\103\003\231\143\306\223\103\350\151\033\311\357\113"
	"\035\377\256\144\317\171\250\222\124\210\213\101\020\011\240\122"
	"\077\265\143\264\270\210\153\020\117\044\135\121\217\077\343\030"
	"\072\331\163\210\320\076\371\372\156\275\070\071\173\022\063\240"
	"\063\210\177\070\375\120\350\054\341\057\053\000\167\215\373\036"
	"\074\034\113\050\214\377\314\222\175\143\000\353\311\276\346\120"
	"\311\213\143\372\376\303\176\073\173\100\113\233\237\245\057\324"
	"\351\324\161\325\162\340\054\143\376\046\146\210\021\130\060\223"
	"\146\076\010\025\173\312\044\265\077\325\307\052\177\146\271\375"
	"\145\165\312\204\027\257\167\200\156\131\036\116\313\242\246\276"
	"\230\241\303\327\346\306\275\210\237\146\314\220\016\110\327\165"
	"\316\046\331\376\262\177\054\026\350\320\106\022\317\040\322\043"
	"\145\053\173\246\025\173\066\353\353\351\344\160\152\054\100\033"
	"\174\007\267\254\360\153\035\226\303\337\104\256\060\253\013\227"
	"\376\215\037\112\034\334\067\374\160\123\046\171\372\103\167\105"
	"\060\274\316\066\072\233\164\154\316\035\336\306\111\306\106\110"
	"\054\252\360\155\354\232\230\053\123\267\036\204\267\262\206\271"
	"\372\376\136\241\035\373\317\305\340\371\176\276\045\250\262\153"
	"\107\373\341\306\036\044\332\371\046\212\073\271\074\021\136\043"
	"\302\102\001\166\056\272\321\207\000\064\157\141\263\274\156\211"
	"\174\164\332\261\044\340\165\141\357\102\155\010\000\122\026\036"
	"\113\303\023\247\111\340\007\163\102\226\315\100\066\241\230\002"
	"\120\006\270\162\366\167\340\173\375\234\224\365\205\277\356\116"
	"\305\330\244\356\251\165\172\342\317\312\237\203\211\123\221\207"
	"\067\216\232\044\072\101\217\314\175\106\226\352\154\305\202\364"
	"\355\260\246\377\200\064\352\065\050\362\325\316\162\153\157\124"
	"\227\177\300\042\150\022\153\004\154\355\204\202\151\372\005\255"
	"\356\152\207\051\213\034\270\176\173\372\173\055\333\310\355\360"
	"\112\152\024\135\055\035\325\233\363\255\070\170\374\022\171\167"
	"\341\300\366\344\241\226\357\233\214\106\215\032\052\277\355\054"
	"\352\051\344\342\145\126\235\062\216\365\010\205\266\341\206\370"
	"\321\275\047\370\167\301\126\053\134\215\145\207\044\101\225\317"
	"\134\101\321\170\341\215\317\045\140\202\043\136\151\067\110\214"
	"\355\345\135\331\012\064\263\120\264\242\117\114\075\234\215\223"
	"\151\270\212\113\212\000\162\322\042\022\016\060\131\241\153\302"
	"\377\103\253\177\137\330\202\355\102\300\124\344\272\072\345\105"
	"\067\105\030\224\070\102\337\014\300\060\074\031\321\250\334\321"
	"\353\207\120\112\140\323\067\243\223\214\207\115\306\155\223\375"
	"\262\254\222\353\357\161\367\257\241\063\311\163\333\245\104\306"
	"\055\224\021\216\147\111\062\373\325\271\111\234\047\334\231\332"
	"\210\054\305\170\235\274\047\076\357\361\261\313\227\365\222\304"
	"\212\243\123\362\354\205\355\302\077\066\136\146\023\370\100\233"
	"\044\005\023\301\302\073\000\262\054\262\175\303\250\017\210\063"
	"\262\333\045\237\141\022\141\240\111\277\007\134\270\110\370\334"
	"\116\014\235\020\107\236\302\164\121\100\070\371\117\300\054\002"
	"\234\122\242\375\145\003\236\256\303\246\013\173\356\003\130\074"
	"\020\366\114\127\224\017\314\345\117\004\337\237\305\014\241\141"
	"\136\103\137\303\107\376\162\013\244\175\207\222\201\337\317\221"
	"\326\033\351\152\053\265\120\172\272\060\031\177\074\273\341\233"
	"\377\101\137\107\077\321\123\344\117\332\167\320\272\106\141\220"
	"\142\113\373\215\000\114\007\273\175\041\072\272\335\034\125\334"
	"\135\264\044\235\206\167\201\325\122\370\245\014\077\007\235\241"
	"\122\231\056\123\345\065\016\143\127\111\035\064\145\162\021\303"
	"\047\066\140\255\255\341\202\000\332\050\015\031\060\252\272\202"
	"\103\350\326\051\036\345\214\166\057\252\253\225\034\274\130\103"
	"\363\270\361\241\232\163\241\165\234\256\216\314\130\111\117\234"
	"\061\045\306\120\013\123\306\072\375\161\320\032\056\050\136\041"
	"\341\117\302\174\303\143\361\137\022\200\053\153\311\172\007\373"
#define      chk2_z	19
#define      chk2	((&data[7012]))
	"\254\042\022\346\226\272\330\175\371\234\171\303\020\170\366\007"
	"\006\367\341\032\055\352\142\037"
#define      pswd_z	256
#define      pswd	((&data[7078]))
	"\262\337\230\324\301\347\227\076\252\373\057\012\015\260\065\170"
	"\171\260\200\164\121\117\300\375\161\322\344\221\126\233\313\011"
	"\173\143\335\075\112\164\173\365\157\253\000\175\133\065\011\050"
	"\007\376\357\022\036\023\332\153\037\042\257\170\214\055\012\016"
	"\055\226\227\240\140\201\162\020\263\354\132\066\161\143\137\171"
	"\141\117\213\200\142\146\354\202\210\233\373\025\310\005\044\366"
	"\234\273\226\374\075\011\015\360\365\147\047\147\313\207\341\055"
	"\326\155\256\071\323\232\273\134\066\266\162\377\274\226\365\130"
	"\122\214\125\217\225\143\200\212\313\250\362\226\057\323\304\006"
	"\100\162\077\024\015\373\161\104\261\344\103\156\173\070\307\315"
	"\305\034\135\132\177\336\345\112\206\327\341\265\253\246\273\353"
	"\031\373\000\046\366\161\152\250\126\256\026\321\347\335\236\254"
	"\372\374\006\172\332\354\305\140\303\246\026\157\115\322\132\146"
	"\315\133\215\303\315\370\154\043\246\202\364\215\140\223\072\132"
	"\220\101\325\152\055\232\313\361\101\342\140\216\264\273\365\202"
	"\026\202\106\343\172\262\007\041\064\374\256\225\217\351\360\037"
	"\052\305\212\127\140\126\110\241\070\250\060\354\143\045\157\172"
	"\250\265\136\043\147\145\104\234\141\363\061\361\334\041\021\006"
	"\346\234\135\106\362\245\350\052\116\031\027\262\076\206\365\325"
	"\346\166\112\070\305\012\065\066\335\031\307\063"
#define      msg1_z	65
#define      msg1	((&data[7357]))
	"\060\365\032\156\100\217\351\066\377\135\173\057\116\374\312\320"
	"\357\025\256\334\370\265\350\314\361\020\300\147\034\011\343\031"
	"\013\305\103\246\300\106\207\001\311\005\005\126\074\137\032\065"
	"\341\374\374\315\254\117\320\031\202\166\026\310\224\142\074\337"
	"\370\333\043\114\306\355\104\265\034\315\225\066\174\361"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
